<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup</title>
    <link rel="stylesheet" href="./style.css">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script> 
    <script src="../config.js"></script>
</head>
<body>
    <div class="container">
    <!-- HTML -->
<table id="raties-table">
    <thead>
      <tr>
        <th>Level</th>
        <th>Content</th>
        <th>Points</th>
        <th>Input Points</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  <button id="save-button">Lưu</button>
  
    </div>
</body>
<script>
    // JavaScript
// Lấy dữ liệu từ Local Storage
function getData(){
    const storedRaties = localStorage.getItem('raties');
    const raties = storedRaties ? JSON.parse(storedRaties) : (CONFIG.raties);
    console.log((raties));

    // Tạo bảng HTML và đổ dữ liệu

    //reset table
    document.querySelector('#raties-table tbody').innerHTML = '';
    const tableBody = document.querySelector('#raties-table tbody');
    Object.keys(raties).forEach((level, index) => {
        const row = tableBody.insertRow();
        const levelCell = row.insertCell(0);
        const contentCell = row.insertCell(1);
        const pointCell = row.insertCell(2);
        const inputCell = row.insertCell(3);

        contentCell.innerText = ['Mất lượt', '1.000', '2.000', '5.000', '10.000', '20.000', '50.000', '100.000','200.000', '500.000'][index];
        levelCell.innerText = index === 0 ? 'Mat luot' : level;
        pointCell.innerText = raties[level];

        const input = document.createElement('input');
        input.type = 'number';
        input.value = raties[level];
        input.addEventListener('change', (event) => {
            raties[level] = parseInt(event.target.value);
            localStorage.setItem('raties', JSON.stringify(raties));
        });
        inputCell.appendChild(input);
    });
}

getData();


// JavaScript
const saveButton = document.querySelector('#save-button');

saveButton.addEventListener('click', () => {
  const tableRows = document.querySelectorAll('#raties-table tbody tr');
  const raties = {};

  tableRows.forEach((row, index) => {
    const level = index === 0 ? '0' : row.cells[0].innerText;
    const points = parseInt(row.cells[3].querySelector('input').value);
    raties[level] = points;
  });

  localStorage.setItem('raties', JSON.stringify(raties));
  //reset table
  getData();
});


</script>
</html>